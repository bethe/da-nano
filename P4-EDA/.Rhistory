aggregate(plm$id, by = Club, FUN=count)
aggregate(plm$id, by = plm$Club, FUN=count)
aggregate(plm$id, by = list(plm$Club), FUN=count)
aggregate(plm$id, by = list(plm$Club), FUN=length)
aggregate(plm$id, by = list(plm$Club), FUN=length/17)
aggregate(subset(plm$id, plm$matchday == 1), by = list(plm$Club), FUN=length)
day1 <- subset(plm$id, plm$matchday == 1)
aggregate(day1, by = list(day1$Club), FUN=length)
day1 <- subset(plm, plm$matchday == 1)
aggregate(day1, by = list(day1$Club), FUN=length)
aggregate(day1, by = list(label(day1$Club)), FUN=length)
aggregate(day1, by = list(name(day1$Club)), FUN=length)
aggregate(day1, by = list(day1$Club), FUN=length)
aggregate(day1$id, by = list(day1$Club), FUN=length)
B04 <- subset(plm, plm$matchday == 1 & Club = "B04")
B04 <- subset(plm, plm$matchday == 1 & Club == "B04")
B04
aggregate(day1$id, by = list(day1$matchday), FUN=length)
aggregate(plm$id, by = list(plm$matchday), FUN=length)
598/17
aggregate(day1$id, by = list(day1$Club), FUN=length)
names(plm)
aggregate(day1$id, by = list(day1$home_squad), FUN=length)
nrow(nonames)
nonames <- subset(plm, is.na(plm$Club))
nrow(nonames)
10166 - 3961
head(nonames)
KOE <- subset(plm, plm$matchday == 1 & Club == "KOE")
B04
KOE
day1 <- subset(plm, plm$matchday == 1)
aggregate(plm$id, by = list(plm$matchday), FUN=length)
names(plm)
head(oneliner)
head(bl_raw)
names(bl_raw)
summary(plm)
ggplot(subset(plm.ranked, !is.na(sum.achievements)),
aes(x=rank, y=total_earnings)) +
geom_point(aes(alpha = game_play_duration,
fill = sum.achievements + bl_points),
pch = 21) +
scale_fill_gradientn(colours = colorRampPalette(c("purple", "red"))(5)) +
geom_line(stat = 'summary', fun.y = mean) +
scale_y_sqrt() +
labs(x="Player Rank (by average earnings)",
y="Earnings per match (sqrt scale)",
title="Match achievements and Player Earnings",
fill="Number of match achievements",
color = "Average Earnings per match",
alpha="Percentage of minutes played")
ggplot(subset(plm.ranked, !is.na(sum.achievements)),
aes(x=rank, y=total_earnings)) +
geom_point(aes(alpha = game_play_duration,
fill = sum.achievements + bl_points),
pch = 21) +
scale_fill_gradientn(colours = colorRampPalette(c("purple", "red"))(5)) +
stat_summary(aes(colour="mean",shape="mean",group=1),
fun.y=mean, geom="line", size=1.1) +
#  geom_line(stat = 'summary', fun.y = mean) +
scale_y_sqrt() +
labs(x="Player Rank (by average earnings)",
y="Earnings per match (sqrt scale)",
title="Match achievements and Player Earnings",
fill="Number of match achievements",
color = "Average Earnings per match",
alpha="Percentage of minutes played")
ggplot(subset(plm.ranked, !is.na(sum.achievements)),
aes(x=rank, y=total_earnings)) +
geom_point(aes(alpha = game_play_duration,
fill = sum.achievements + bl_points),
pch = 21) +
scale_fill_gradientn(colours = colorRampPalette(c("purple", "red"))(5)) +
stat_summary(fun.y=mean, geom="line", size=1.1) +
#  geom_line(stat = 'summary', fun.y = mean) +
scale_y_sqrt() +
labs(x="Player Rank (by average earnings)",
y="Earnings per match (sqrt scale)",
title="Match achievements and Player Earnings",
fill="Number of match achievements",
color = "Average Earnings per match",
alpha="Percentage of minutes played")
ggplot(subset(plm.ranked, !is.na(sum.achievements)),
aes(x=rank, y=total_earnings)) +
geom_point(aes(alpha = game_play_duration,
fill = sum.achievements + bl_points),
pch = 21) +
scale_fill_gradientn(colours = colorRampPalette(c("purple", "red"))(5)) +
stat_summary(fun.y=mean, geom="line", size=1.1, name = "Mean") +
#  geom_line(stat = 'summary', fun.y = mean) +
scale_y_sqrt() +
labs(x="Player Rank (by average earnings)",
y="Earnings per match (sqrt scale)",
title="Match achievements and Player Earnings",
fill="Number of match achievements",
color = "Average Earnings per match",
alpha="Percentage of minutes played")
ggplot(subset(plm.ranked, !is.na(sum.achievements)),
aes(x=rank, y=total_earnings)) +
geom_point(aes(alpha = game_play_duration,
fill = sum.achievements + bl_points),
pch = 21) +
scale_fill_gradientn(colours = colorRampPalette(c("purple", "red"))(5)) +
stat_summary(fun.y=mean, geom="line", size=1.1, aes(name = "Average")) +
#  geom_line(stat = 'summary', fun.y = mean) +
scale_y_sqrt() +
labs(x="Player Rank (by average earnings)",
y="Earnings per match (sqrt scale)",
title="Match achievements and Player Earnings",
fill="Number of match achievements",
color = "Average Earnings per match",
alpha="Percentage of minutes played")
ggplot(subset(plm.ranked, !is.na(sum.achievements)),
aes(x=rank, y=total_earnings)) +
geom_point(aes(alpha = game_play_duration,
fill = sum.achievements + bl_points),
pch = 21) +
scale_fill_gradientn(colours = colorRampPalette(c("purple", "red"))(5)) +
stat_summary(fun.y=mean, geom="line", size=1.1, aes(size = "Average")) +
#  geom_line(stat = 'summary', fun.y = mean) +
scale_y_sqrt() +
labs(x="Player Rank (by average earnings)",
y="Earnings per match (sqrt scale)",
title="Match achievements and Player Earnings",
fill="Number of match achievements",
color = "Average Earnings per match",
alpha="Percentage of minutes played")
ggplot(subset(plm.ranked, !is.na(sum.achievements)),
aes(x=rank, y=total_earnings)) +
geom_point(aes(alpha = game_play_duration,
fill = sum.achievements + bl_points),
pch = 21) +
scale_fill_gradientn(colours = colorRampPalette(c("purple", "red"))(5)) +
geom_line(stat = 'summary', fun.y = mean) +
scale_y_sqrt() +
labs(x="Player Rank (by average earnings)",
y="Earnings per match (sqrt scale)",
title="Match achievements and Player Earnings",
fill="Number of match achievements",
color = "Average Earnings per match",
alpha="Percentage of minutes played")
ggplot(subset(plm.ranked, !is.na(sum.achievements)),
aes(x=rank, y=total_earnings)) +
geom_point(aes(alpha = fill = sum.achievements + bl_points),
pch = 21) +
scale_fill_gradientn(colours = colorRampPalette(c("purple", "red"))(5)) +
geom_line(stat = 'summary', fun.y = mean) +
scale_y_sqrt() +
labs(x="Player Rank (by average earnings)",
y="Earnings per match (sqrt scale)",
title="Match achievements and Player Earnings",
fill="Number of match achievements",
color = "Average Earnings per match")
ggplot(subset(plm.ranked, !is.na(sum.achievements)),
aes(x=rank, y=total_earnings)) +
geom_point(aes(fill = sum.achievements + bl_points),
pch = 21) +
scale_fill_gradientn(colours = colorRampPalette(c("purple", "red"))(5)) +
geom_line(stat = 'summary', fun.y = mean) +
scale_y_sqrt() +
labs(x="Player Rank (by average earnings)",
y="Earnings per match (sqrt scale)",
title="Match achievements and Player Earnings",
fill="Number of match achievements",
color = "Average Earnings per match")
ggplot(subset(plm.ranked, !is.na(sum.achievements)),
aes(x=rank, y=total_earnings)) +
geom_point(aes(fill = sum.achievements + bl_points)) +
scale_fill_gradientn(colours = colorRampPalette(c("purple", "red"))(5)) +
geom_line(stat = 'summary', fun.y = mean) +
scale_y_sqrt() +
labs(x="Player Rank (by average earnings)",
y="Earnings per match (sqrt scale)",
title="Match achievements and Player Earnings",
fill="Number of match achievements",
color = "Average Earnings per match")
ggplot(subset(plm.ranked, !is.na(sum.achievements)),
aes(x=rank, y=total_earnings)) +
geom_point(aes(color = sum.achievements + bl_points)) +
scale_fill_gradientn(colours = colorRampPalette(c("purple", "red"))(5)) +
geom_line(stat = 'summary', fun.y = mean) +
scale_y_sqrt() +
labs(x="Player Rank (by average earnings)",
y="Earnings per match (sqrt scale)",
title="Match achievements and Player Earnings",
fill="Number of match achievements",
color = "Average Earnings per match")
ggplot(subset(plm.ranked, !is.na(sum.achievements)),
aes(x=rank, y=total_earnings)) +
geom_point(aes(color = sum.achievements + bl_points)) +
scale_colour_brewer() +
#  scale_fill_gradientn(colours = colorRampPalette(c("purple", "red"))(5)) +
geom_line(stat = 'summary', fun.y = mean) +
scale_y_sqrt() +
labs(x="Player Rank (by average earnings)",
y="Earnings per match (sqrt scale)",
title="Match achievements and Player Earnings",
fill="Number of match achievements",
color = "Average Earnings per match")
ggplot(subset(plm.ranked, !is.na(sum.achievements)),
aes(x=rank, y=total_earnings)) +
geom_point(aes(color = sum.achievements + bl_points)) +
scale_colour_brewer(sum.achievements + bl_points) +
#  scale_fill_gradientn(colours = colorRampPalette(c("purple", "red"))(5)) +
geom_line(stat = 'summary', fun.y = mean) +
scale_y_sqrt() +
labs(x="Player Rank (by average earnings)",
y="Earnings per match (sqrt scale)",
title="Match achievements and Player Earnings",
fill="Number of match achievements",
color = "Average Earnings per match")
ggplot(subset(plm.ranked, !is.na(sum.achievements)),
aes(x=rank, y=total_earnings)) +
geom_point(aes(color = sum.achievements + bl_points)) +
scale_colour_brewer(plm.ranked$sum.achievements + plm.ranked$bl_points) +
#  scale_fill_gradientn(colours = colorRampPalette(c("purple", "red"))(5)) +
geom_line(stat = 'summary', fun.y = mean) +
scale_y_sqrt() +
labs(x="Player Rank (by average earnings)",
y="Earnings per match (sqrt scale)",
title="Match achievements and Player Earnings",
fill="Number of match achievements",
color = "Average Earnings per match")
ggplot(subset(plm.ranked, !is.na(sum.achievements)),
aes(x=rank, y=total_earnings)) +
geom_point(aes(color = sum.achievements + bl_points)) +
scale_colour_discrete() +
#  scale_fill_gradientn(colours = colorRampPalette(c("purple", "red"))(5)) +
geom_line(stat = 'summary', fun.y = mean) +
scale_y_sqrt() +
labs(x="Player Rank (by average earnings)",
y="Earnings per match (sqrt scale)",
title="Match achievements and Player Earnings",
fill="Number of match achievements",
color = "Average Earnings per match")
ggplot(subset(plm.ranked, !is.na(sum.achievements)),
aes(x=rank, y=total_earnings)) +
geom_point(aes(color = sum.achievements + bl_points)) +
scale_colour_brewer(type = "div") +
#  scale_fill_gradientn(colours = colorRampPalette(c("purple", "red"))(5)) +
geom_line(stat = 'summary', fun.y = mean) +
scale_y_sqrt() +
labs(x="Player Rank (by average earnings)",
y="Earnings per match (sqrt scale)",
title="Match achievements and Player Earnings",
fill="Number of match achievements",
color = "Average Earnings per match")
ggplot(subset(plm.ranked, !is.na(sum.achievements)),
aes(x=rank, y=total_earnings)) +
geom_point(aes(color = sum.achievements + bl_points)) +
scale_colour_continuous() +
#  scale_fill_gradientn(colours = colorRampPalette(c("purple", "red"))(5)) +
geom_line(stat = 'summary', fun.y = mean) +
scale_y_sqrt() +
labs(x="Player Rank (by average earnings)",
y="Earnings per match (sqrt scale)",
title="Match achievements and Player Earnings",
fill="Number of match achievements",
color = "Average Earnings per match")
ggplot(subset(plm.ranked, !is.na(sum.achievements)),
aes(x=rank, y=total_earnings)) +
geom_point(aes(color = sum.achievements + bl_points)) +
scale_colour_continuous(low = "white") +
#  scale_fill_gradientn(colours = colorRampPalette(c("purple", "red"))(5)) +
geom_line(stat = 'summary', fun.y = mean) +
scale_y_sqrt() +
labs(x="Player Rank (by average earnings)",
y="Earnings per match (sqrt scale)",
title="Match achievements and Player Earnings",
fill="Number of match achievements",
color = "Average Earnings per match")
ggplot(subset(plm.ranked, !is.na(sum.achievements)),
aes(x=rank, y=total_earnings)) +
geom_point(aes(color = sum.achievements + bl_points)) +
scale_colour_continuous(low = "white", high = "blue") +
#  scale_fill_gradientn(colours = colorRampPalette(c("purple", "red"))(5)) +
geom_line(stat = 'summary', fun.y = mean) +
scale_y_sqrt() +
labs(x="Player Rank (by average earnings)",
y="Earnings per match (sqrt scale)",
title="Match achievements and Player Earnings",
fill="Number of match achievements",
color = "Average Earnings per match")
ggplot(subset(plm.ranked, !is.na(sum.achievements)),
aes(x=rank, y=total_earnings)) +
geom_point(aes(color = sum.achievements + bl_points, alpha = 0.5)) +
scale_colour_continuous(low = "white", high = "blue") +
#  scale_fill_gradientn(colours = colorRampPalette(c("purple", "red"))(5)) +
geom_line(stat = 'summary', fun.y = mean) +
scale_y_sqrt() +
labs(x="Player Rank (by average earnings)",
y="Earnings per match (sqrt scale)",
title="Match achievements and Player Earnings",
fill="Number of match achievements",
color = "Average Earnings per match")
ggplot(subset(plm.ranked, !is.na(sum.achievements)),
aes(x=rank, y=total_earnings)) +
geom_point(aes(color = sum.achievements + bl_points, alpha = 0.5)) +
scale_colour_continuous() +
#  scale_fill_gradientn(colours = colorRampPalette(c("purple", "red"))(5)) +
geom_line(stat = 'summary', fun.y = mean) +
scale_y_sqrt() +
labs(x="Player Rank (by average earnings)",
y="Earnings per match (sqrt scale)",
title="Match achievements and Player Earnings",
fill="Number of match achievements",
color = "Average Earnings per match")
ggplot(subset(plm.ranked, !is.na(sum.achievements)),
aes(x=rank, y=total_earnings)) +
geom_point(aes(color = sum.achievements + bl_points, alpha = 0.5)) +
scale_colour_continuous(low = "white", high = "dodgerblue") +
#  scale_fill_gradientn(colours = colorRampPalette(c("purple", "red"))(5)) +
geom_line(stat = 'summary', fun.y = mean) +
scale_y_sqrt() +
labs(x="Player Rank (by average earnings)",
y="Earnings per match (sqrt scale)",
title="Match achievements and Player Earnings",
fill="Number of match achievements",
color = "Average Earnings per match")
ggplot(subset(plm.ranked, !is.na(sum.achievements)),
aes(x=rank, y=total_earnings)) +
geom_point(aes(color = factor(sum.achievements + bl_points),
alpha = 0.5)) +
scale_colour_brewer() +
#  scale_fill_gradientn(colours = colorRampPalette(c("purple", "red"))(5)) +
geom_line(stat = 'summary', fun.y = mean) +
scale_y_sqrt() +
labs(x="Player Rank (by average earnings)",
y="Earnings per match (sqrt scale)",
title="Match achievements and Player Earnings",
fill="Number of match achievements",
color = "Average Earnings per match")
ggplot(subset(plm.ranked, !is.na(sum.achievements)),
aes(x=rank, y=total_earnings)) +
geom_point(aes(color = factor(sum.achievements + bl_points),
alpha = 0.5)) +
scale_colour_brewer(guide = "colorbar") +
#  scale_fill_gradientn(colours = colorRampPalette(c("purple", "red"))(5)) +
geom_line(stat = 'summary', fun.y = mean) +
scale_y_sqrt() +
labs(x="Player Rank (by average earnings)",
y="Earnings per match (sqrt scale)",
title="Match achievements and Player Earnings",
fill="Number of match achievements",
color = "Average Earnings per match")
ggplot(subset(plm.ranked, !is.na(sum.achievements)),
aes(x=rank, y=total_earnings)) +
geom_point(aes(color = factor(sum.achievements + bl_points),
alpha = 0.5)) +
scale_colour_brewer(guide = "colourbar") +
#  scale_fill_gradientn(colours = colorRampPalette(c("purple", "red"))(5)) +
geom_line(stat = 'summary', fun.y = mean) +
scale_y_sqrt() +
labs(x="Player Rank (by average earnings)",
y="Earnings per match (sqrt scale)",
title="Match achievements and Player Earnings",
fill="Number of match achievements",
color = "Average Earnings per match")
ggplot(subset(plm.ranked, !is.na(sum.achievements)),
aes(x=rank, y=total_earnings)) +
geom_point(aes(color = factor(sum.achievements + bl_points)),
alpha = 0.5) +
scale_colour_brewer() +
#  scale_fill_gradientn(colours = colorRampPalette(c("purple", "red"))(5)) +
geom_line(stat = 'summary', fun.y = mean) +
scale_y_sqrt() +
labs(x="Player Rank (by average earnings)",
y="Earnings per match (sqrt scale)",
title="Match achievements and Player Earnings",
fill="Number of match achievements",
color = "Average Earnings per match")
ggplot(subset(plm.ranked, !is.na(sum.achievements)),
aes(x=rank, y=total_earnings)) +
geom_point(aes(color = factor(sum.achievements + bl_points)),
alpha = 0.8) +
scale_colour_brewer() +
#  scale_fill_gradientn(colours = colorRampPalette(c("purple", "red"))(5)) +
geom_line(stat = 'summary', fun.y = mean) +
scale_y_sqrt() +
labs(x="Player Rank (by average earnings)",
y="Earnings per match (sqrt scale)",
title="Match achievements and Player Earnings",
fill="Number of match achievements",
color = "Average Earnings per match")
ggplot(plm.matchup, aes(x = Club, y = opponent, fill = avg_earnings)) +
geom_tile() +
#  scale_fill_gradientn(colours = colorRampPalette(c("blue", "red"))(100)) +
labs(x = "Players' Club", y = "Opponent in a match",
title = "Average player earnings by match",
fill = "Average Earnings")
ggplot(plm.matchup, aes(x = Club, y = opponent, fill = avg_earnings)) +
geom_tile() +
scale_fill_gradientn(direction = -1)
labs(x = "Players' Club", y = "Opponent in a match",
title = "Average player earnings by match",
fill = "Average Earnings")
ggplot(plm.matchup, aes(x = Club, y = opponent, fill = avg_earnings)) +
geom_tile() +
scale_fill_gradientn(direction = -1) +
labs(x = "Players' Club", y = "Opponent in a match",
title = "Average player earnings by match",
fill = "Average Earnings")
ggplot(plm.matchup, aes(x = Club, y = opponent, fill = avg_earnings)) +
geom_tile() +
scale_fill_gradient(direction = -1) +
labs(x = "Players' Club", y = "Opponent in a match",
title = "Average player earnings by match",
fill = "Average Earnings")
ggplot(plm.matchup, aes(x = Club, y = opponent, fill = avg_earnings)) +
geom_tile() +
labs(x = "Players' Club", y = "Opponent in a match",
title = "Average player earnings by match",
fill = "Average Earnings")
ggplot(plm.matchup, aes(x = Club, y = opponent, fill = avg_earnings)) +
geom_tile() +
scale_fill_distiller() +
labs(x = "Players' Club", y = "Opponent in a match",
title = "Average player earnings by match",
fill = "Average Earnings")
ggplot(subset(plm.ranked, !is.na(sum.achievements)),
aes(x=rank, y=total_earnings)) +
geom_point(aes(color = factor(sum.achievements + bl_points)),
alpha = 0.8) +
scale_colour_brewer() +
geom_line(stat = 'summary', fun.y = mean) +
scale_y_sqrt() +
labs(x="Player Rank (by average earnings)",
y="Earnings per match (sqrt scale)",
title="Match achievements and Player Earnings",
fill="Number of match achievements",
color = "Average Earnings per match")
ggplot(subset(plm.ranked, !is.na(sum.achievements)),
aes(x=rank, y=total_earnings)) +
geom_point(aes(color = factor(sum.achievements + bl_points)),
alpha = 0.8) +
scale_color_distiller() +
#  scale_colour_brewer() +
geom_line(stat = 'summary', fun.y = mean) +
scale_y_sqrt() +
labs(x="Player Rank (by average earnings)",
y="Earnings per match (sqrt scale)",
title="Match achievements and Player Earnings",
fill="Number of match achievements",
color = "Average Earnings per match")
ggplot(subset(plm.ranked, !is.na(sum.achievements)),
aes(x=rank, y=total_earnings)) +
geom_point(aes(color = sum.achievements + bl_points),
alpha = 0.8) +
scale_color_distiller() +
#  scale_colour_brewer() +
geom_line(stat = 'summary', fun.y = mean) +
scale_y_sqrt() +
labs(x="Player Rank (by average earnings)",
y="Earnings per match (sqrt scale)",
title="Match achievements and Player Earnings",
fill="Number of match achievements",
color = "Average Earnings per match")
ggplot(subset(plm.ranked, !is.na(sum.achievements)),
aes(x=rank, y=total_earnings)) +
geom_point(aes(color = sum.achievements + bl_points),
alpha = 0.8) +
scale_color_distiller(direction = -1) +
#  scale_colour_brewer() +
geom_line(stat = 'summary', fun.y = mean) +
scale_y_sqrt() +
labs(x="Player Rank (by average earnings)",
y="Earnings per match (sqrt scale)",
title="Match achievements and Player Earnings",
fill="Number of match achievements",
color = "Average Earnings per match")
ggplot(subset(plm.ranked, !is.na(sum.achievements)),
aes(x=rank, y=total_earnings)) +
geom_point(aes(color = sum.achievements + bl_points),
alpha = 0.8) +
scale_color_distiller(direction = 1) +
#  scale_colour_brewer() +
geom_line(stat = 'summary', fun.y = mean) +
scale_y_sqrt() +
labs(x="Player Rank (by average earnings)",
y="Earnings per match (sqrt scale)",
title="Match achievements and Player Earnings",
fill="Number of match achievements",
color = "Average Earnings per match")
ggplot(plm.matchup, aes(x = Club, y = opponent, fill = avg_earnings)) +
geom_tile() +
scale_fill_distiller(direction = 1) +
labs(x = "Players' Club", y = "Opponent in a match",
title = "Average player earnings by match",
fill = "Average Earnings")
ggplot(aes(x = status), data = subset(plm, plm$total_earnings == 0)) +
geom_histogram()
ggplot(aes(x = status), data = subset(plm, plm$total_earnings == 0)) +
geom_histogram(stat = "count")
qplot(x = status,data = subset(plm, plm$total_earnings == 0)
)
plm.matchcount <- plm.played %>%
group_by(id) %>%
summarize(n = n()) %>%
arrange(id)
qplot(x=n, plm.matchcount)
head(plm.matchcount)
qplot(x=factor(n), data = plm.matchcount)
qplot(x=factor(sum.achievements), data = plm)
qplot(x=factor(sum.achievements), data = plm) +
y_scale_sqrt()
qplot(x=factor(sum.achievements), data = plm) +
scale_y_sqrt()
qplot(x=factor(sum.achievements), data = plm) +
scale_y_log10()
qplot(x=game_play_duration, data=subset(plm, id %in% sample.ids))
qplot(x=factor(sum.achievements + bl_points), data = plm)
